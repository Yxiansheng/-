# Webpack 常见问题

- webpack 运行流程

1. 初始化参数：从配置文件和 Shell 命令中得到参数然后组合为最终参数；
2. 开始编译：利用上一步得到的参数初始化 Compiler 对象，加载所有配置的插件，执行 compiler 的 run (启动一次新的编译) 方法开始执行编译；；
3. 确定入口：根据配置中 entry 属性分析入口
4. 编译模块：从入口文件出发，递归获取不同模块的依赖，根据引入的不同类型的模块调用配置的 loader 进行解析。
5. 完成编译：经过第4步，得到对应每个模块被翻译的最终内容及模块之间的依赖关系
6. 输出资源：根据入口和各模块的依赖关系组合起来为一个个 chunk ，再将每个 chunk 转换为一个单独的文件加到输出列表。
7. 输出完成：根绝配置确定好要输出的文件名及路径，再写入到文件系统。

- webpack 可通过 file-loader 或者 url-loader 来解析图片，但 url-loader 可通过传入 limit 参数来限制超过多大的图片才打包为单独的图片，否则就转为 base64 格式的字符串混入到js中，减少网络请求。

- 可以通过 optimization.splitChunks.cacheGroups 选项，所有的 CSS 可以被提取到一个 CSS 文件中。

- Tree-shaking 的本质是消除无用的代码减少构建后的包体积。其原理是利用 es6 的模块语法(import 和 export)的特点：
  1. 只能作为模块顶层的语句出现
  2. import 的模块名只能是字符串常量
  3. import binding 是 immutable （不可变）的
  由于上述特点，es6 的模块依赖关系是确定的，和运行时的状态无关，可以从代码进行分析。而 commonJs 等的模块化，require 一个模块，只有执行后才知道引用的是什么模块，不能做静态分析。